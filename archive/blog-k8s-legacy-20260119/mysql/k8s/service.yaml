# ==============================================================================
# MySQL Service
# ==============================================================================
# 목적: MySQL Pod를 클러스터 내부에서 접근 가능하도록 노출
#
# 주요 설정:
# - type: ClusterIP (클러스터 내부 접근만, 외부 노출 안 함)
# - port: 3306 (MySQL 기본 포트)
# - selector: app=mysql (MySQL Pod 선택)
#
# Service Discovery:
# - WAS가 jdbc:mysql://mysql-service:3306/board 로 접속
# - 같은 Namespace면 mysql-service로 충분
# - 다른 Namespace면 mysql-service.blog-system.svc.cluster.local
# ==============================================================================
apiVersion: v1
kind: Service
metadata:
  name: mysql-service
  namespace: blog-system
  labels:
    app: mysql
    tier: database
spec:
  type: ClusterIP  # 클러스터 내부 접근만 (외부 노출 안 함)

  selector:
    app: mysql  # Deployment의 label과 일치

  ports:
  - name: mysql
    protocol: TCP
    port: 3306        # Service가 노출하는 포트
    targetPort: 3306  # Container의 포트 (containerPort와 일치)

  # ClusterIP를 고정하지 않음 (자동 할당)
  # clusterIP: None → Headless Service (StatefulSet 용도)
