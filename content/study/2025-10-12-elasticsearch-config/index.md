---
title: "ES config 설정 부터 구조 까지 한번에 알아보자"
date: 2025-10-12T10:58:39-04:00
draft: false
categories: ["DevOps", "", "Elasticsearch","data-pipeline"]
tags: ["Elasticsearch", "Json"]
description: "ES의 Config 설정에 대해서 상세히 알아보자"
author: "늦찌민"
series: ["ES 구축기"]
---

 ### ✅ 엘라스틱서치 데이터 색인 및 구조

- **색인(Indexing):**데이터가 검색될 수 있는 구조로 변경하기 위해 원본 문서를 검색어 토큰들로 변환하여 저장 하는 일련의 과정
- **문서(document)**: 엘라스틱 서치가 저장하고 색인을 생성하는 JSON 문서를 뜻한다.
- **인덱스**: 문서를 모아 놓은 단위가 인덱스 클라이언트는 이 인덱스 단위로 엘라스틱서치에 고가용성을 제공하기 위해 샤드의 내용을 복제 원본 역할을 담당하는 샤드를 주 샤드(Primary shard)라고 하고 복제본 샤드 (replication shard)라고 한다.
- **_id:** 인덱스 내 문서에 부여되는 고유한 구분자다. 인덱스 이름과 _id 의 좋바은 엘라스틱 서치 클래스터내에 고유
- **타입:** 엘라스틱 서치는 과거에 하나의 인덱스 안에 있는 여러 문서를 묶어서 타입이라는 논리 단위로 나눔 
ex) 상품 정보를 담는 하나의 인덱스 안에 가전타입,식품타입 등 여러 타입을 두어 문서를 논리적인 단위로 구분하는데에 사용

### ✅ 엘라스틱 서치 클러스터 종류

- **노드 :** 엘라스티서치 프로세스 하나가 노드 하나를 구성 엘라스틱 서치 노드 하나는 여러 개의 샤드를 가짐  고가용성을 위해 같은 종류의 샤드를 같은 노드에 배치 하지 않는다.
0번 복제본 샤드 두개가 같은 노드에 배치 되지 않음
- **클러스터:** 이러한 엘라스틱 서치 노드 여러 개가 모여 클러스터를 구성
- **노드의 역할:** 엘라스틱 서치의 노드는 데이터노드,마스터노드,조정노드 등 여러 역할 중 하나 이상의 역할을 맡아 수행한다. 샤드를 보유하고 샤드에 실제 읽기와 쓰기 작업을 수행하는 노드를 데이터 노드
클러스터를 관리하는 중요한 역할을 하는 것은 마스터노드

### ✅ Elasticsearch.yml 설정 값

- **cluster.name:”클러스터명”**
클러스터명을 설정이 가능하다. Elasticsearch 노드들은 클러스터명이 같으면 간은 클러스터로 무낑고 클러스터명이 다르면 동일한 물맂거 장비나 바인딩이 가능한 네트워크 상에 있더라도 서로 다른 클러스터로 바인딩 된다. **고유 이름을** 사용 하여함
- **node.name:”<노드명>”
실행 중인 각각의 Elasticsearch** 노드들은 구분할 수있는 노드 이름으로 지정
- **network.host: <ip 주소>**
    
    Elasticsearch가 실행되는 서버의 ip 주소입니다. 디폴트는 루프백(127.0.0.1) 입니다. 주석 처리 되어 있거나 루프백인 경우에는 Elasticsearch 노드가 개발 모드로 실행이 됩니다. 만약에 이 설정을 실제 IP 주소로 변경하게 되면 그 때부터는 운영 모드로 실행이 되며 노드를 시작할 때 부트스트랩 체크를 하게 됩니다. network.host는 서버의 내/외부 주소를 모두 지정하는데 만약 내부망에서 사용하는 주소와 외부망에서 접근하는 주소를 다르게 설정하고자 하면 아래의 값 들을 이용해서 구분이 가능합니다.
    
    - `network.bind_host` : 내부망
    - `network.publish_host` : 외부망
    
    그리고 network.host 설정에 사용되는 특별한 변수값이 있는데 다음과 같습니다.
    
    - `_local_` : 루프백 주소 127.0.0.1 과 같습니다. 디폴트로 설정되어 있습니다.
    - `_site_` : 로컬 네트워크 주소로 설정됩니다. 실제로 클러스터링 구성 시 주로 설정하는 값입니다.
    - `_global_` : 네트워크 외부에서 바라보는 주소로 설정합니다.
    
    실제로 클러스터를 구성할 때 설정을 `network.host: _site_` 로 해 놓으면 서버의 네트워크 주소가 바뀌어도 설정 파일은 변경하지 않아도 되기 때문에 편리합니다.
    
- **http.port:<포트번호>**
Elasticsearch 가 클라이언트와 통신하기 위한 http 포트를 설정 디폴트 9200 이며 9200 ~ 9299사이 사용 여러 포트를 사용 한 호스트에서 멀티 노드를 사용할 수 있음
- **transport.port:<포트번호>**
Elaistchsearch 노드들끼리 서로 통하기 위한 tcp 포트를 설정 디폴트는 9300 이며 9300~ 9399 사용가능
- **discovery.seed_hosts:[”<host-1>”,”<host-2>”, … ]
클러스터 구성을 위해 바인딩할 원격 노드의 IP 또는 도메인 주소를 배열 형태로 입력
주소만 적는 경우 디폴트로 9300~9305 포트 값을 검색 tcp 포트가 이밖에 설정된 경우 포트 번호를 같이 적어 줘야함**
- **cluster.initial_master_nodes: [ "<노드-1>", "<노드-2>" ]**
    
    클러스터가 최초 실행 될 때 명시된 노드들을 대상으로 마스터 노드를 선출합니다. 마스터 노드에 대해서는 [3.3 마스터 노드와 데이터 노드](https://esbook.kimjmin.net/03-cluster/3.3-master-and-data-nodes) 장에서 자세 다루도록 하겠습니다.
    
- **cluster.initial_master_nodes** 옵션 역시 7.0 부터 추가된 기능입니다. 6.x 이전 버전에서는 최소 마스터 후보 노드를 지정하기 위해 다음 옵션을 사용했습니다. 7.0 버전 부터는 최소 마스터 후보 노드의 크기가 능동적으로 변경됩니다.
    
-  **discovery.zen.minimum_master_nodes: 2**
    
    노드 실행시 지정된 환경변수를 elasticsearch.yml 에서 ${환경변수명} 형식으로 사용이 가능합니다.