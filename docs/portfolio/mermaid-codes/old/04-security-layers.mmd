flowchart TD
    Internet[ğŸŒ Internet<br/>ì•…ì˜ì  íŠ¸ë˜í”½]

    L7_CDN[ğŸ›¡ï¸ L7: Cloudflare WAF<br/>SQL Injection ì°¨ë‹¨<br/>XSS ì°¨ë‹¨<br/>DDoS ë°©ì–´]

    L7_Istio[ğŸ” L7: Istio mTLS<br/>Service ê°„ ì•”í˜¸í™”<br/>PERMISSIVE ëª¨ë“œ]

    L4_Cilium[ğŸš§ L4: NetworkPolicy<br/>Pod íŠ¸ë˜í”½ ì œì–´<br/>L7 Protocol ì¸ì‹]

    Runtime[âš¡ Runtime: Falco IDS/IPS<br/>syscall ëª¨ë‹ˆí„°ë§<br/>Talon ìë™ ê²©ë¦¬]

    App[ğŸ”’ App: SecurityContext<br/>runAsNonRoot<br/>drop ALL capabilities]

    Pod[ğŸ“¦ Application Pod<br/>WEB, WAS, MySQL]

    Internet -->|ê³µê²©| L7_CDN
    L7_CDN -->|í•„í„°ë§| L7_Istio
    L7_Istio -->|mTLS| L4_Cilium
    L4_Cilium -->|í—ˆìš©| Runtime
    Runtime -->|ì •ìƒ| App
    App -->|ì¤€ìˆ˜| Pod

    L7_CDN -.->|ì°¨ë‹¨| Internet
    L7_Istio -.->|ì°¨ë‹¨| Internet
    L4_Cilium -.->|DROP| Internet
    Runtime -.->|ê²©ë¦¬| Pod

    style Internet fill:#ff6b6b
    style L7_CDN fill:#ffd700
    style L7_Istio fill:#87ceeb
    style L4_Cilium fill:#98fb98
    style Runtime fill:#ffb6c1
    style App fill:#dda0dd
    style Pod fill:#90ee90
