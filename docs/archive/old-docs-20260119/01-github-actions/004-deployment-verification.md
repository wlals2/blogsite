# ë°°í¬ í”Œë¡œìš° ê²€ì¦ ë° ì•„í‚¤í…ì²˜ í™•ì¸

> ì‘ì„±ì¼: 2026-01-17
> ëª©ì : Hugo ë¸”ë¡œê·¸ê°€ ì‹¤ì œë¡œ ì–´ë””ì„œ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸í•˜ê³ , ë°°í¬ í”Œë¡œìš° ëª…í™•íˆ ì •ë¦¬

---

## ğŸ“‹ ëª©ì°¨

1. [í•µì‹¬ ì§ˆë¬¸ê³¼ ë‹µë³€](#1-í•µì‹¬-ì§ˆë¬¸ê³¼-ë‹µë³€)
2. [ì‹¤ì œ ë°°í¬ í”Œë¡œìš° ì¶”ì ](#2-ì‹¤ì œ-ë°°í¬-í”Œë¡œìš°-ì¶”ì )
3. [ì˜ëª»ëœ ì´í•´ì™€ ì˜¬ë°”ë¥¸ ì´í•´](#3-ì˜ëª»ëœ-ì´í•´ì™€-ì˜¬ë°”ë¥¸-ì´í•´)
4. [ì•„í‚¤í…ì²˜ ê²€ì¦ ê³¼ì •](#4-ì•„í‚¤í…ì²˜-ê²€ì¦-ê³¼ì •)
5. [ë°œê²¬í•œ ìœ ë¬¼ (ì‚¬ìš© ì•ˆ í•˜ëŠ” ì„¤ì •)](#5-ë°œê²¬í•œ-ìœ ë¬¼-ì‚¬ìš©-ì•ˆ-í•˜ëŠ”-ì„¤ì •)
6. [ìµœì¢… ì •ë¦¬](#6-ìµœì¢…-ì •ë¦¬)

---

## 1. í•µì‹¬ ì§ˆë¬¸ê³¼ ë‹µë³€

### Q1: https://blog.jiminhome.shop/ ì´ê²Œ Kubernetesë¡œ ëœ¨ê³  ìˆëŠ”ê±°ì•¼ ë¡œì»¬êº¼ì•¼?

**A**: âœ… **Kubernetesì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤!**

**ì¦ê±°**:
```bash
# 1. Kubernetes web Pod í™•ì¸
kubectl get pods -n blog-system -l app=web
# NAME                   READY   STATUS    RESTARTS   AGE     IP           NODE
# web-795b44bf96-2qbdj   1/1     Running   0          130m    10.0.2.2     k8s-worker1
# web-795b44bf96-67822   1/1     Running   0          3h13m   10.0.1.188   k8s-worker2

# 2. ì´ë¯¸ì§€ ë²„ì „ í™•ì¸
kubectl get deployment web -n blog-system -o jsonpath='{.spec.template.spec.containers[0].image}'
# ghcr.io/wlals2/blog-web:v11 â† Jenkinsë¡œ ìë™ ë°°í¬ëœ ì´ë¯¸ì§€

# 3. Service ì—”ë“œí¬ì¸íŠ¸ í™•ì¸ (ì‹¤ì œ íŠ¸ë˜í”½ ê°€ëŠ” ê³³)
kubectl get endpoints web-service -n blog-system
# NAME          ENDPOINTS
# web-service   10.0.1.188:80,10.0.2.2:80 â† 2ê°œ Podì— Load Balancing
```

---

### Q2: ë¡œì»¬ì—ì„œ ë¨¼ì € ëœ¨ê³  ë‹¤ì‹œ Kubernetesê°€ ëœ¬ë‹¤ëŠ”ê±° ì•„ëƒ?

**A**: âŒ **ì•„ë‹ˆìš”!** ë¡œì»¬ nginxëŠ” Hugoë¥¼ ì‹¤í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

**ë¡œì»¬ nginxì˜ ì—­í• **:
- âœ… HTTPS â†’ HTTP ë³€í™˜ (SSL Termination)
- âœ… CloudFlare IP ì¸ì‹
- âœ… **í”„ë¡ì‹œ** (Kubernetesë¡œ ìš”ì²­ ì „ë‹¬)
- âŒ Hugo ë¸”ë¡œê·¸ ì„œë¹™ (ì•ˆ í•¨!)

**nginx ì„¤ì • ì¦ê±°**:
```nginx
# /etc/nginx/sites-available/blog
location / {
    proxy_pass http://192.168.1.187:31852;  # â† Kubernetesë¡œ í”„ë¡ì‹œë§Œ!
    # root /var/www/blog ê°™ì€ ì„¤ì • ì—†ìŒ!
}
```

---

## 2. ì‹¤ì œ ë°°í¬ í”Œë¡œìš° ì¶”ì 

### 2.1 ì „ì²´ íŠ¸ë˜í”½ ê²½ë¡œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì‚¬ìš©ì ë¸Œë¼ìš°ì €                                              â”‚
â”‚ https://blog.jiminhome.shop/                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTPS (443)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CloudFlare CDN (ê¸€ë¡œë²Œ ìºì‹œ)                                 â”‚
â”‚ - server: cloudflare                                         â”‚
â”‚ - cf-cache-status: DYNAMIC                                   â”‚
â”‚ - cf-ray: 9bf5da6a3a7f9b81-HKG                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTPS (443)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë¡œì»¬ nginx (192.168.1.187:443)                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ ì—­í• :                                               â”‚     â”‚
â”‚ â”‚ 1. SSL Termination (Let's Encrypt)                  â”‚     â”‚
â”‚ â”‚ 2. CloudFlare ì‹¤ì œ IP ì¸ì‹                          â”‚     â”‚
â”‚ â”‚ 3. í”„ë¡ì‹œ (Kubernetesë¡œ ì „ë‹¬)                       â”‚     â”‚
â”‚ â”‚                                                     â”‚     â”‚
â”‚ â”‚ proxy_pass http://192.168.1.187:31852               â”‚     â”‚
â”‚ â”‚ â€» Hugo ì„œë¹™ ì•ˆ í•¨! (root ì„¤ì • ì—†ìŒ)                â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP (31852)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kubernetes Ingress (nginx-ingress)                          â”‚
â”‚ - NodePort: 31852                                            â”‚
â”‚ - Path-based Routing:                                        â”‚
â”‚   â€¢ / â†’ web-service:80                                       â”‚
â”‚   â€¢ /api â†’ was-service:8080                                  â”‚
â”‚   â€¢ /board â†’ was-service:8080                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP (80)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ web-service (ClusterIP)                                      â”‚
â”‚ - Type: ClusterIP (cluster ë‚´ë¶€ì—ì„œë§Œ ì ‘ê·¼)                 â”‚
â”‚ - Endpoints: 10.0.1.188:80, 10.0.2.2:80                      â”‚
â”‚ - Load Balancing: 2ê°œ Podì— ê· ë“± ë¶„ë°°                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP (80)
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ web Pod (1/2)   â”‚             â”‚ web Pod (2/2)   â”‚
â”‚ k8s-worker1     â”‚             â”‚ k8s-worker2     â”‚
â”‚ IP: 10.0.2.2    â”‚             â”‚ IP: 10.0.1.188  â”‚
â”‚                 â”‚             â”‚                 â”‚
â”‚ Container:      â”‚             â”‚ Container:      â”‚
â”‚ - nginx:alpine  â”‚             â”‚ - nginx:alpine  â”‚
â”‚ - Image: v11    â”‚             â”‚ - Image: v11    â”‚
â”‚ - Hugo HTML ì„œë¹™â”‚             â”‚ - Hugo HTML ì„œë¹™â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Hugo ì •ì  HTML      â”‚
          â”‚ /usr/share/nginx/   â”‚
          â”‚        html/         â”‚
          â”‚                     â”‚
          â”‚ ghcr.io/wlals2/     â”‚
          â”‚   blog-web:v11      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2.2 CI/CD íŒŒì´í”„ë¼ì¸ (ì‹¤ì œ ì‚¬ìš© ì¤‘)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Developer                                                   â”‚
â”‚ 1. Markdown íŒŒì¼ ì‘ì„± (content/posts/my-post.md)           â”‚
â”‚ 2. git add . && git commit -m "Add new post"               â”‚
â”‚ 3. git push origin main                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GitHub Repository (blogsite)                                â”‚
â”‚ https://github.com/wlals2/blogsite                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ Webhook (ë˜ëŠ” ìˆ˜ë™ íŠ¸ë¦¬ê±°)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Jenkins (localhost:8080)                                     â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ Stage 1: Git Checkout (5ì´ˆ)                        â”‚     â”‚
â”‚ â”‚   git clone https://github.com/wlals2/blogsite.git â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ Stage 2: Docker Build (30ì´ˆ)                       â”‚     â”‚
â”‚ â”‚                                                     â”‚     â”‚
â”‚ â”‚   Multi-stage Build:                               â”‚     â”‚
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚
â”‚ â”‚   â”‚ Stage 1: Builder (alpine + hugo)         â”‚     â”‚     â”‚
â”‚ â”‚   â”‚   RUN apk add hugo tzdata                â”‚     â”‚     â”‚
â”‚ â”‚   â”‚   COPY . .                               â”‚     â”‚     â”‚
â”‚ â”‚   â”‚   RUN hugo --minify --gc                 â”‚     â”‚     â”‚
â”‚ â”‚   â”‚   â†’ public/ ë””ë ‰í† ë¦¬ ìƒì„±                â”‚     â”‚     â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚
â”‚ â”‚                                                     â”‚     â”‚
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚
â”‚ â”‚   â”‚ Stage 2: Runtime (nginx:alpine)          â”‚     â”‚     â”‚
â”‚ â”‚   â”‚   COPY --from=builder /src/public        â”‚     â”‚     â”‚
â”‚ â”‚   â”‚        /usr/share/nginx/html             â”‚     â”‚     â”‚
â”‚ â”‚   â”‚   â†’ ìµœì¢… ì´ë¯¸ì§€ í¬ê¸°: ~20MB              â”‚     â”‚     â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚
â”‚ â”‚                                                     â”‚     â”‚
â”‚ â”‚   docker build -t ghcr.io/wlals2/blog-web:v11 .   â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ Stage 3: Push to GHCR (20ì´ˆ)                       â”‚     â”‚
â”‚ â”‚   docker push ghcr.io/wlals2/blog-web:v11          â”‚     â”‚
â”‚ â”‚   docker push ghcr.io/wlals2/blog-web:latest       â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ Stage 4: Deploy to K8s (10ì´ˆ)                      â”‚     â”‚
â”‚ â”‚   kubectl set image deployment/web \               â”‚     â”‚
â”‚ â”‚       nginx=ghcr.io/wlals2/blog-web:v11 \          â”‚     â”‚
â”‚ â”‚       -n blog-system                               â”‚     â”‚
â”‚ â”‚   kubectl rollout status deployment/web            â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ Stage 5: Health Check (10ì´ˆ)                       â”‚     â”‚
â”‚ â”‚   curl -f http://192.168.1.187:31852/ || exit 1   â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚ ì´ ë¹Œë“œ ì‹œê°„: ~1.5ë¶„                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kubernetes                                                  â”‚
â”‚                                                             â”‚
â”‚ Rolling Update:                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ Before: [Pod v10] [Pod v10]                        â”‚     â”‚
â”‚ â”‚ Step 1: [Pod v10] [Pod v10] [Pod v11 Creating]     â”‚     â”‚
â”‚ â”‚ Step 2: [Pod v10] [Pod v11 Running]                â”‚     â”‚
â”‚ â”‚ Step 3: [Pod v11] [Pod v11] âœ…                      â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚ ë¬´ì¤‘ë‹¨ ë°°í¬ ì™„ë£Œ!                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                  3ë¶„ í›„ ì‚¬ìš©ìì—ê²Œ ë°˜ì˜ âœ…
```

---

### 2.3 ê²€ì¦ ê³¼ì •

#### 1. CloudFlare ì‘ë‹µ í™•ì¸
```bash
curl -I https://blog.jiminhome.shop/

# ê²°ê³¼:
# HTTP/2 200
# server: cloudflare
# cf-cache-status: DYNAMIC
# cf-ray: 9bf5da6a3a7f9b81-HKG
```
â†’ CloudFlareë¥¼ í†µí•´ ì˜¤ëŠ” ê²ƒ í™•ì¸ âœ…

---

#### 2. Kubernetes ì§ì ‘ ì ‘ì†
```bash
curl -I http://192.168.1.187:31852/

# ê²°ê³¼:
# HTTP/1.1 200 OK
# Date: Sat, 17 Jan 2026 12:28:48 GMT
# Content-Type: text/html
```
â†’ NodePortë¡œ ì§ì ‘ Kubernetes ì ‘ì† ê°€ëŠ¥ âœ…

---

#### 3. nginx ì„¤ì • í™•ì¸
```bash
cat /etc/nginx/sites-available/blog

# ê²°ê³¼:
# location / {
#     proxy_pass http://192.168.1.187:31852;  # â† Kubernetesë¡œ í”„ë¡ì‹œ
#     proxy_set_header Host $host;
#     ...
# }
#
# â€» root /var/www/blog ê°™ì€ ì„¤ì • ì—†ìŒ!
```
â†’ nginxëŠ” í”„ë¡ì‹œë§Œ í•¨ (Hugo ì„œë¹™ ì•ˆ í•¨) âœ…

---

#### 4. Pod ë¶„ì‚° ìƒíƒœ í™•ì¸
```bash
kubectl get pods -n blog-system -l app=web -o wide

# ê²°ê³¼:
# NAME                   READY   STATUS    NODE          IP
# web-795b44bf96-2qbdj   1/1     Running   k8s-worker1   10.0.2.2
# web-795b44bf96-67822   1/1     Running   k8s-worker2   10.0.1.188
```
â†’ 2ê°œ ë…¸ë“œì— ë¶„ì‚° ë°°í¬ âœ…

---

#### 5. Service ì—”ë“œí¬ì¸íŠ¸ í™•ì¸
```bash
kubectl get endpoints web-service -n blog-system

# ê²°ê³¼:
# NAME          ENDPOINTS
# web-service   10.0.1.188:80,10.0.2.2:80
```
â†’ 2ê°œ Podì— Load Balancing ë™ì‘ âœ…

---

#### 6. ë™ì¼ ì½˜í…ì¸  ê²€ì¦
```bash
# A. Kubernetesì—ì„œ ì§ì ‘ ê°€ì ¸ì˜¨ ë‚´ìš©
curl -s http://192.168.1.187:31852/ | grep -o "<title>.*</title>"
# <title>Jimin | Cloud Engineer Journey</title>

# B. HTTPS (CloudFlare â†’ nginx â†’ K8s)ë¥¼ í†µí•´ ê°€ì ¸ì˜¨ ë‚´ìš©
curl -sk https://blog.jiminhome.shop/ | grep -o "<title>.*</title>"
# <title>Jimin | Cloud Engineer Journey</title>
```
â†’ ë™ì¼í•œ ì½˜í…ì¸  í™•ì¸ âœ…

---

## 3. ì˜ëª»ëœ ì´í•´ì™€ ì˜¬ë°”ë¥¸ ì´í•´

### 3.1 ì˜ëª»ëœ ì´í•´ âŒ

```
ì‚¬ìš©ì
  â†“
CloudFlare
  â†“
ë¡œì»¬ nginx (Hugo ì„œë¹™) â† ì—¬ê¸°ì„œ Hugo ì‹¤í–‰! âŒ
  â†“
Kubernetes (ë‹¤ì‹œ Hugo ì„œë¹™?) â† ì¤‘ë³µ? âŒ
```

**ì´ë ‡ê²Œ ìƒê°í•œ ì´ìœ **:
- `/var/www/blog` ë””ë ‰í† ë¦¬ê°€ ì¡´ì¬í•¨
- GitHub Actionsê°€ `/var/www/blog`ë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ìˆìŒ
- nginx ì„¤ì • íŒŒì¼ì— `server_name blog.jiminhome.shop` ìˆìŒ

---

### 3.2 ì˜¬ë°”ë¥¸ ì´í•´ âœ…

```
ì‚¬ìš©ì
  â†“
CloudFlare (CDN)
  â†“
ë¡œì»¬ nginx (í”„ë¡ì‹œë§Œ!) â† Hugo ì‹¤í–‰ ì•ˆ í•¨! âœ…
  â†“ proxy_pass
Kubernetes (Hugo ì„œë¹™) â† ì—¬ê¸°ì„œë§Œ Hugo ì‹¤í–‰! âœ…
```

**ì‹¤ì œ ë™ì‘**:
- ë¡œì»¬ nginx: **HTTPS â†’ HTTP ë³€í™˜ + í”„ë¡ì‹œ**ë§Œ ìˆ˜í–‰
- `/var/www/blog`: **ì‚¬ìš© ì•ˆ ë¨** (ê³¼ê±° ì„¤ì •ì˜ ìœ ë¬¼)
- Kubernetes: **ì‹¤ì œ Hugo ë¸”ë¡œê·¸ ì„œë¹™**

---

### 3.3 ë¡œì»¬ nginxì˜ ì‹¤ì œ ì—­í• 

```nginx
server {
    listen 443 ssl http2;
    server_name blog.jiminhome.shop;

    # 1. SSL ì¸ì¦ì„œ (Let's Encrypt)
    ssl_certificate     /etc/letsencrypt/live/blog.jiminhome.shop/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/blog.jiminhome.shop/privkey.pem;

    # 2. CloudFlare ì‹¤ì œ IP ì¸ì‹
    set_real_ip_from 173.245.48.0/20;
    # ... (CloudFlare IP ë²”ìœ„)
    real_ip_header CF-Connecting-IP;

    # 3. ë³´ì•ˆ í—¤ë”
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header Referrer-Policy "strict-origin-when-cross-origin" always;

    # 4. Kubernetesë¡œ í”„ë¡ì‹œ (í•µì‹¬!)
    location / {
        proxy_pass http://192.168.1.187:31852;  # â† Kubernetes Ingress
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket ì§€ì›
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        # íƒ€ì„ì•„ì›ƒ
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
}
```

**ì—­í•  ìš”ì•½**:
1. **SSL Termination**: HTTPS â†’ HTTP ë³€í™˜
2. **IP ì¸ì‹**: CloudFlare ì‹¤ì œ IP ì¶”ì¶œ
3. **ë³´ì•ˆ í—¤ë”**: XSS, Clickjacking ë°©ì§€
4. **í”„ë¡ì‹œ**: Kubernetesë¡œ ìš”ì²­ ì „ë‹¬

**Hugo ì„œë¹™**: âŒ ì•ˆ í•¨!

---

## 4. ì•„í‚¤í…ì²˜ ê²€ì¦ ê³¼ì •

### 4.1 ë¡œì»¬ nginx í”„ë¡œì„¸ìŠ¤ í™•ì¸

```bash
ps aux | grep nginx | grep -v grep

# ê²°ê³¼:
# root     1017  nginx: master process
# www-data 2264516  nginx: worker process (12ê°œ)
```

**ë¶„ì„**:
- nginx í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ ì¤‘ âœ…
- í•˜ì§€ë§Œ Hugo í”„ë¡œì„¸ìŠ¤ëŠ” ì—†ìŒ
- HugoëŠ” Kubernetes Pod ë‚´ë¶€ì—ì„œë§Œ ì‹¤í–‰

---

### 4.2 /var/www/blog ë””ë ‰í† ë¦¬ í™•ì¸

```bash
ls -la /var/www/blog/

# ê²°ê³¼:
# drwxr-xr-x  18 www-data www-data    4096 Jan 17 11:33 .
# -rw-r--r--   1 www-data www-data    6587 Jan 17 11:33 404.html
# drwxr-xr-x   2 www-data www-data    4096 Jan 17 11:33 about
# ...
```

**ë¶„ì„**:
- `/var/www/blog` ë””ë ‰í† ë¦¬ ì¡´ì¬ âœ…
- Jan 17 11:33ì— ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ë¨
- **í•˜ì§€ë§Œ nginxê°€ ì½ì§€ ì•ŠìŒ!** (root ì„¤ì • ì—†ìŒ)

---

### 4.3 nginx ì„¤ì • í™•ì¸

```bash
cat /etc/nginx/sites-available/blog | grep -E "root|proxy_pass"

# ê²°ê³¼:
# proxy_pass http://192.168.1.187:31852;
# (root ì„¤ì • ì—†ìŒ!)
```

**ë¶„ì„**:
- `root /var/www/blog` ì„¤ì • ì—†ìŒ! âœ…
- `proxy_pass`ë§Œ ì¡´ì¬
- â†’ nginxëŠ” `/var/www/blog`ë¥¼ ì½ì§€ ì•ŠìŒ

---

### 4.4 /var/www/blog ì‚¬ìš© ì—¬ë¶€ í™•ì¸

```bash
sudo lsof 2>/dev/null | grep "/var/www/blog" | head -5

# ê²°ê³¼:
# (ì¶œë ¥ ì—†ìŒ)
```

**ë¶„ì„**:
- ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ë„ `/var/www/blog`ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ âœ…
- â†’ ì™„ì „íˆ ì‚¬ìš© ì•ˆ ë˜ëŠ” ë””ë ‰í† ë¦¬

---

### 4.5 Kubernetes web Pod í™•ì¸

```bash
kubectl get pods -n blog-system -l app=web -o custom-columns=\
  NAME:.metadata.name,\
  NODE:.spec.nodeName,\
  IMAGE:.spec.containers[0].image

# ê²°ê³¼:
# NAME                   NODE          IMAGE
# web-795b44bf96-2qbdj   k8s-worker1   ghcr.io/wlals2/blog-web:v11
# web-795b44bf96-67822   k8s-worker2   ghcr.io/wlals2/blog-web:v11
```

**ë¶„ì„**:
- 2ê°œ Pod ì‹¤í–‰ ì¤‘ âœ…
- 2ê°œ ë…¸ë“œì— ë¶„ì‚° âœ…
- ì´ë¯¸ì§€: Jenkinsë¡œ ìë™ ë°°í¬ëœ v11 âœ…

---

## 5. ë°œê²¬í•œ ìœ ë¬¼ (ì‚¬ìš© ì•ˆ í•˜ëŠ” ì„¤ì •)

### 5.1 GitHub Actions (/var/www/blog ì—…ë°ì´íŠ¸)

**ë°œê²¬í•œ íŒŒì¼**:
```bash
/home/jimin/blogsite/.github/workflows/deploy-improved.yml
/home/jimin/blogsite/.github/workflows/deploy.yml.backup
```

**ë‚´ìš©**:
```yaml
# GitHub Actionsê°€ ì—¬ì „íˆ /var/www/blog ì—…ë°ì´íŠ¸ ì¤‘
- name: Deploy to Server
  run: |
    sudo mkdir -p /var/www/blog
    sudo rsync -avh --delete public/ /var/www/blog/
    sudo chown -R www-data:www-data /var/www/blog
```

**ìƒíƒœ**: âš ï¸ ì‹¤í–‰ë˜ê³  ìˆì§€ë§Œ **ì‚¬ìš©ë˜ì§€ ì•ŠìŒ!**

---

### 5.2 ì™œ /var/www/blogê°€ ì—…ë°ì´íŠ¸ë˜ë‚˜?

**ê³¼ê±° (ë¡œì»¬ ì„œë¹™ ì‹œì ˆ)**:
```
GitHub Actions
  â†“
Hugo ë¹Œë“œ
  â†“
rsync public/ /var/www/blog/
  â†“
nginx (root /var/www/blog) â† ë¡œì»¬ì—ì„œ ì§ì ‘ ì„œë¹™
  â†“
ì‚¬ìš©ì
```

**í˜„ì¬ (Kubernetes ì „í™˜ í›„)**:
```
GitHub Actions (ì—¬ì „íˆ ì‹¤í–‰ ì¤‘)
  â†“
Hugo ë¹Œë“œ
  â†“
rsync public/ /var/www/blog/ â† ì—…ë°ì´íŠ¸ëŠ” ë˜ì§€ë§Œ...
  â†“
(ì‚¬ìš© ì•ˆ ë¨!) â† nginxê°€ ì½ì§€ ì•ŠìŒ!

ë³„ë„ë¡œ:
Jenkins
  â†“
Docker build
  â†“
Kubernetes ë°°í¬ â† ì‹¤ì œë¡œ ì´ê²ƒë§Œ ì‚¬ìš©ë¨!
```

---

### 5.3 /var/www/blogì˜ ìš©ë„?

**í˜„ì¬**:
- âŒ nginxê°€ ì½ì§€ ì•ŠìŒ
- âŒ Hugo ì„œë¹™ì— ì‚¬ìš© ì•ˆ ë¨
- âš ï¸ GitHub Actionsê°€ ì—…ë°ì´íŠ¸ë§Œ í•¨ (ì˜ë¯¸ ì—†ìŒ)

**ê°€ëŠ¥í•œ ìš©ë„**:
- âœ… ë°±ì—… (Kubernetes ì¥ì•  ì‹œ ë³µêµ¬ìš©)
- âœ… ë¡œì»¬ í…ŒìŠ¤íŠ¸ (í•„ìš” ì‹œ nginx ì„¤ì • ë³€ê²½)
- âŒ í˜„ì¬ëŠ” ì™„ì „íˆ ë¶ˆí•„ìš”

**ê°œì„  ë°©ì•ˆ**:
1. GitHub Actions ì›Œí¬í”Œë¡œìš°ì—ì„œ `/var/www/blog` ì—…ë°ì´íŠ¸ ì œê±°
2. ë˜ëŠ” ë°±ì—… ìš©ë„ë¡œ ìœ ì§€ (ëª…ì‹œì  í‘œì‹œ)

---

## 6. ìµœì¢… ì •ë¦¬

### 6.1 ì‹¤ì œ ë°°í¬ í”Œë¡œìš° (í˜„ì¬)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ê°œë°œìê°€ ê¸€ ì‘ì„±                                       â”‚
â”‚    ~/blogsite/content/posts/new-post.md                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                    git push
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Jenkins CI/CD (ì‹¤ì œ ì‚¬ìš© âœ…)                          â”‚
â”‚    - Checkout                                            â”‚
â”‚    - Docker Build (Multi-stage, Hugo ë¹Œë“œ í¬í•¨)          â”‚
â”‚    - GHCR Push (ghcr.io/wlals2/blog-web:v11)            â”‚
â”‚    - kubectl set image (Rolling Update)                 â”‚
â”‚    ì´ ë¹Œë“œ ì‹œê°„: ~1.5ë¶„                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Kubernetes (ì‹¤ì œ ì„œë¹™ âœ…)                             â”‚
â”‚    - web Pod 2ê°œ (worker1, worker2)                      â”‚
â”‚    - ghcr.io/wlals2/blog-web:v11                         â”‚
â”‚    - ê³ ê°€ìš©ì„±: ë…¸ë“œ ë¶„ì‚°, Load Balancing                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP (31852)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ë¡œì»¬ nginx (í”„ë¡ì‹œë§Œ âœ…)                              â”‚
â”‚    - SSL Termination (HTTPS â†’ HTTP)                      â”‚
â”‚    - CloudFlare IP ì¸ì‹                                  â”‚
â”‚    - proxy_pass http://192.168.1.187:31852               â”‚
â”‚    â€» /var/www/blog ì‚¬ìš© ì•ˆ í•¨!                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTPS (443)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. CloudFlare CDN (ê¸€ë¡œë²Œ ìºì‹œ)                          â”‚
â”‚    - cf-cache-status: DYNAMIC                            â”‚
â”‚    - ì „ ì„¸ê³„ ì—£ì§€ ì„œë²„                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                    ì‚¬ìš©ì ì ‘ì†
```

---

### 6.2 ì‚¬ìš© ì•ˆ í•˜ëŠ” í”Œë¡œìš° (ìœ ë¬¼)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GitHub Actions (ê³¼ê±° ì„¤ì • - ì‚¬ìš© ì•ˆ í•¨ âš ï¸)               â”‚
â”‚    - Hugo ë¹Œë“œ                                           â”‚
â”‚    - rsync public/ /var/www/blog/                        â”‚
â”‚    - /var/www/blog ì—…ë°ì´íŠ¸ (Jan 17 11:33)               â”‚
â”‚                                                          â”‚
â”‚ â€» nginxê°€ ì½ì§€ ì•Šìœ¼ë¯€ë¡œ ì˜ë¯¸ ì—†ìŒ!                       â”‚
â”‚ â€» Kubernetesë¡œ ì „í™˜ í›„ ë¶ˆí•„ìš”í•œ ì„¤ì •                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 6.3 í•µì‹¬ ìš”ì•½

| ì§ˆë¬¸ | ë‹µë³€ |
|------|------|
| **Hugo ë¸”ë¡œê·¸ëŠ” ì–´ë””ì„œ ì‹¤í–‰ë˜ë‚˜?** | âœ… Kubernetes (web Pod 2ê°œ) |
| **ë¡œì»¬ nginxê°€ Hugoë¥¼ ì„œë¹™í•˜ë‚˜?** | âŒ ì•„ë‹ˆìš”, í”„ë¡ì‹œë§Œ í•¨ |
| **`/var/www/blog`ëŠ” ì‚¬ìš©ë˜ë‚˜?** | âŒ ì•„ë‹ˆìš”, ìœ ë¬¼ (ê³¼ê±° ì„¤ì •) |
| **ì‹¤ì œ CI/CDëŠ” ë¬´ì—‡ì¸ê°€?** | âœ… Jenkins (Docker build â†’ GHCR â†’ K8s) |
| **GitHub ActionsëŠ” ë¬´ì—‡ì„ í•˜ë‚˜?** | âš ï¸ `/var/www/blog` ì—…ë°ì´íŠ¸ (ë¶ˆí•„ìš”) |

---

### 6.4 íŠ¸ë˜í”½ ê²½ë¡œ ìš”ì•½

```
ì‚¬ìš©ì
  â†“ HTTPS
CloudFlare (ê¸€ë¡œë²Œ CDN)
  â†“ HTTPS
ë¡œì»¬ nginx (SSL Termination + í”„ë¡ì‹œ)
  â†“ HTTP (31852)
Kubernetes Ingress (Path-based Routing)
  â†“ HTTP (80)
web-service (Load Balancing)
  â†“ HTTP (80)
web Pod (2ê°œ, nginx container)
  â†“
Hugo ì •ì  HTML (ghcr.io/wlals2/blog-web:v11)
```

**í•µì‹¬**:
- âœ… Kubernetes ë‹¨ì¼ ì†ŒìŠ¤
- âœ… ë¡œì»¬ nginxëŠ” í”„ë¡ì‹œë§Œ
- âœ… `/var/www/blog`ëŠ” ì‚¬ìš© ì•ˆ ë¨

---

### 6.5 ê°œì„  ì œì•ˆ

#### 1. GitHub Actions ì›Œí¬í”Œë¡œìš° ì •ë¦¬
**í˜„ì¬**:
```yaml
# .github/workflows/deploy-improved.yml
- name: Deploy to Server
  run: |
    sudo rsync -avh --delete public/ /var/www/blog/  # â† ë¶ˆí•„ìš”!
```

**ê°œì„ **:
```yaml
# Option 1: ì™„ì „ ì œê±°
# (í•´ë‹¹ step ì‚­ì œ)

# Option 2: ë°±ì—… ìš©ë„ë¡œ ëª…ì‹œ
- name: Backup to Local (Fallback)
  run: |
    sudo rsync -avh --delete public/ /var/www/blog-backup/
    echo "Backup only - not used by nginx"
```

---

#### 2. nginx ì„¤ì • ì£¼ì„ ì¶”ê°€
**í˜„ì¬**:
```nginx
location / {
    proxy_pass http://192.168.1.187:31852;
}
```

**ê°œì„ **:
```nginx
# ========== Kubernetes Ingressë¡œ í”„ë¡ì‹œ ==========
# Hugo ë¸”ë¡œê·¸ëŠ” Kubernetesì—ì„œ ì‹¤í–‰ë¨ (web Pod 2ê°œ)
# ë¡œì»¬ nginxëŠ” SSL Termination + í”„ë¡ì‹œë§Œ ìˆ˜í–‰
# /var/www/blogëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ!
location / {
    proxy_pass http://192.168.1.187:31852;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
```

---

#### 3. ë¬¸ì„œí™”
**ì´ ë¬¸ì„œê°€ ê·¸ ì—­í• !**

---

## 7. ê²€ì¦ ëª…ë ¹ì–´ ëª¨ìŒ

### ì „ì²´ í”Œë¡œìš° í•œ ë²ˆì— í™•ì¸
```bash
echo "=== 1. CloudFlare í™•ì¸ ===" && \
curl -sI https://blog.jiminhome.shop/ | grep "cf-cache\|server:" && \
echo "" && \
echo "=== 2. Kubernetes ì§ì ‘ ì ‘ì† ===" && \
curl -sI http://192.168.1.187:31852/ | head -3 && \
echo "" && \
echo "=== 3. web Pod ë¶„ì‚° ìƒíƒœ ===" && \
kubectl get pods -n blog-system -l app=web -o custom-columns=NAME:.metadata.name,NODE:.spec.nodeName,IMAGE:.spec.containers[0].image && \
echo "" && \
echo "=== 4. Service ì—”ë“œí¬ì¸íŠ¸ ===" && \
kubectl get endpoints web-service -n blog-system && \
echo "" && \
echo "=== 5. nginx ì„¤ì • í™•ì¸ ===" && \
cat /etc/nginx/sites-available/blog | grep "proxy_pass"
```

---

### nginxê°€ /var/www/blogë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ í™•ì¸
```bash
# 1. nginx ì„¤ì •ì—ì„œ root ê²€ìƒ‰
cat /etc/nginx/sites-available/blog | grep "root"
# (ì¶œë ¥ ì—†ìŒ = /var/www/blog ì‚¬ìš© ì•ˆ í•¨)

# 2. lsofë¡œ /var/www/blog ì‚¬ìš© í™•ì¸
sudo lsof 2>/dev/null | grep "/var/www/blog"
# (ì¶œë ¥ ì—†ìŒ = ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ë„ ì‚¬ìš© ì•ˆ í•¨)

# 3. nginx workerê°€ ì–´ë–¤ íŒŒì¼ì„ ì—´ê³  ìˆëŠ”ì§€ í™•ì¸
sudo lsof -p $(pgrep -f "nginx: worker" | head -1) | grep -E "\.html|\.css|\.js"
# (blog ê´€ë ¨ íŒŒì¼ ì—†ìŒ = nginxê°€ Hugo íŒŒì¼ ì½ì§€ ì•ŠìŒ)
```

---

### Kubernetesì—ì„œ Hugo íŒŒì¼ í™•ì¸
```bash
# Pod ë‚´ë¶€ Hugo íŒŒì¼ í™•ì¸
kubectl exec -n blog-system $(kubectl get pods -n blog-system -l app=web -o jsonpath='{.items[0].metadata.name}') \
  -- ls -la /usr/share/nginx/html/ | head -10

# Podì—ì„œ index.html ë‚´ìš© í™•ì¸
kubectl exec -n blog-system $(kubectl get pods -n blog-system -l app=web -o jsonpath='{.items[0].metadata.name}') \
  -- cat /usr/share/nginx/html/index.html | head -20
```

---

## 8. ì°¸ê³  ë¬¸ì„œ

- [COMPLETE-PROJECT-GUIDE.md](./COMPLETE-PROJECT-GUIDE.md) - ì „ì²´ í”„ë¡œì íŠ¸ ê°€ì´ë“œ
- [HUGO-WEB-CICD-SETUP.md](./HUGO-WEB-CICD-SETUP.md) - Hugo CI/CD ìƒì„¸ ê°€ì´ë“œ
- [why-self-hosted-runner.md](./why-self-hosted-runner.md) - Self-Hosted Runner ì„ íƒ ì´ìœ 

---

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-01-17
**ì‘ì„±ì**: Jimin
**ê²€í† **: Claude Code (AI Assistant)
**ë¬¸ì„œ ìƒíƒœ**: âœ… ì™„ë£Œ

---

## ë¶€ë¡: ìš©ì–´ ì •ë¦¬

| ìš©ì–´ | ì„¤ëª… |
|------|------|
| **í”„ë¡ì‹œ (Proxy)** | í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ ì‚¬ì´ì—ì„œ ìš”ì²­ì„ ì „ë‹¬í•˜ëŠ” ì¤‘ê³„ ì„œë²„ |
| **SSL Termination** | HTTPSë¥¼ HTTPë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì • (SSL ì¸ì¦ì„œ ì²˜ë¦¬) |
| **NodePort** | Kubernetes Service íƒ€ì…, ëª¨ë“  ë…¸ë“œì˜ íŠ¹ì • í¬íŠ¸ë¡œ ì ‘ê·¼ ê°€ëŠ¥ |
| **Load Balancing** | ì—¬ëŸ¬ ì„œë²„(Pod)ì— íŠ¸ë˜í”½ì„ ê· ë“±í•˜ê²Œ ë¶„ë°° |
| **Rolling Update** | ë¬´ì¤‘ë‹¨ ë°°í¬ (ìƒˆ Pod ìƒì„± â†’ ê¸°ì¡´ Pod ì¢…ë£Œ) |
| **Multi-stage Build** | Docker ì´ë¯¸ì§€ ë¹Œë“œ ìµœì í™” (ë¹Œë“œ / ì‹¤í–‰ ë‹¨ê³„ ë¶„ë¦¬) |
